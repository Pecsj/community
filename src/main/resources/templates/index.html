<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>主页</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" href="css/my.css">
		<script src="js/jquery-3.4.1.min.js" type="application/javascript"></script>
		<script src="js/bootstrap.min.js" type="application/javascript"></script>

	</head>
	<body>
<!--		导航条-->
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
					</button>
					<a class="navbar-brand" th:href="@{/}">杰享</a>
				</div>

				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<form class="navbar-form navbar-left">
						<div class="form-group">
							<input type="text" class="form-control" placeholder="搜索帖子">
						</div>
						<button type="submit" class="btn btn-default">搜索</button>
					</form>
					<ul class="nav navbar-nav navbar-right">
						<li th:if="${session.user != null}">
							<a th:href="${#httpServletRequest.getContextPath()+'/publish'}" style="margin-top: 3px">发帖</a>
						</li>
						<li th:if="${session.user == null}">
							<a th:href="@{/github}">github登录</a>
						</li>
						<li th:if="${session.user == null}">
							<a th:href="@{/login}">登录</a>
						</li>
						<li th:if="${session.user == null}">
							<a th:href="@{/register}">注册</a>
						</li>
						<li th:if="${session.user != null}" class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
								<span th:text="${session.user.getName()}"></span>
								<span class="caret"></span>
								<img th:src="${session.user.AvatarUrl !='' && session.user.AvatarUrl !=null} ? ${session.user.AvatarUrl} :'img/default.jpg'" class="img-circle" width="25px" height="25px">
							</a>
							<ul class="dropdown-menu">
								<li><a th:href="@{/myinfo}">个人信息</a></li>
								<li><a th:href="@{/myarticle}">我的发帖</a></li>
								<li><a th:href="@{/mymessage}">消息</a></li>
								<li role="separator" class="divider"></li>
								<li><a th:href="@{/loginout}">注销</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>
<!--		滚动公告-->
<div th:if="${session.message}!=null">
	<p th:text="${session.message}"></p>
</div>
<!--		主题内容-->
<div class="container-fluid main">
	<div class="row">
		<!--            栏目头-->
		<div class="col-md-8 col-lg-8 col-sm-12 col-xs-12">
			<h2>
				<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
				<span>帖子</span>
			</h2>
			<hr>
<!--			帖子列表-->
			<div th:if="${pageInfo != null}" class="media articleDiv" th:each="item : ${pageInfo.list}">
				<div class="media-left">
					<a href="#">
						<img class="media-object img-rounded listimg" th:src="${item.user.avatarUrl == null} ? 'img/default.jpg':${item.user.avatarUrl}" alt="头像">
					</a>
				</div>
				<div class="media-body">
					<h4 class="media-heading" style="color: #2aabd2"><span th:text="${item.title}"></span></h4>
					&nbsp;&nbsp;<span th:text="${item.description}"></span>
					<div class="listtext">
						<a class="btn btn-default" href="#" role="button"><span th:text="${item.user.name}"></span></a>
						<span style="color: #999999">阅读·<span th:text="${item.viewCount}"></span> &nbsp;&nbsp;评论·<span th:text="${item.commentCount}"></span> &nbsp;&nbsp;点赞·<span th:text="${item.likeCount}"></span> &nbsp;&nbsp;<span th:text="${#dates.format(item.gmtCreat,'yyyy MM dd')}"></span></span>
					</div>
				</div>
			</div>
<!--			分页-->
			<nav aria-label="Page navigation">
				<ul class="pagination">
<!--					当前页面是第一页-->
					<li th:if="${pageInfo.pageNum == 1}" class="disabled">
						<a href="#" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
						</a>
					</li>
					<li th:if="${pageInfo.pageNum != 1}">
						<a th:href="'index?pageNumber='+${pageInfo.prePage}" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
						</a>
					</li>

<!--					遍历标签-->
					<li th:each="nav : ${pageInfo.navigatepageNums}" th:classappend="${pageInfo.pageNum == nav} ? 'active' : ''">
						<!--当前页面是所在页面-->
						<a class="active" th:href="'index?pageNumber='+${nav}" th:text="${nav}"></a>
					</li>

<!--					不是最后一页-->
					<li th:if="${pageInfo.pageNum != pageInfo.pages}">
						<a th:href="'index?pageNumber='+${pageInfo.nextPage}" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
						</a>
					</li>
					<li th:if="${pageInfo.pageNum == pageInfo.pages}" class="disabled" aria-label="Next">
						<a href="#" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
						</a>
					</li>
				</ul>
			</nav>

		</div>

		<!--            友情提示-->
		<div class="col-md-4 col-lg-4 col-sm-12 col-xs-12" style="margin-top: 50px">
			<div class="panel panel-primary">
				<div class="panel-body">
					热门话题/标签
				</div>
				<div class="panel-footer">
					热门话题/标签
					* 你好
					* java
					* ssm
				</div>
			</div>

			<div class="panel panel-danger">
				<div class="panel-heading">实时疫情信息展示</div>
				<div class="panel-body">
					<p>实时疫情信息展示</p>
				</div>

				<!-- Table -->
				<table class="table">

				</table>
			</div>

			<div class="panel panel-default">
				<div class="panel-body">
					友情链接
				</div>
				<div class="panel-footer">
					<ul>
						<li><a href="http://www.baidu.com">百度</a></li>
						<li><a href="http://www.baidu.com">百度</a></li>
					</ul>
				</div>
			</div>



		</div>
	</div>
</div>

<!--			底部-版权信息-->









<!--模态框-->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					用户未登录
				</h4>
			</div>
			<div class="modal-body" th:text="${error}">
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script th:inline="javascript">
	$(function(){
		var msg = [[${error}]];
		if(msg!=""&&msg!=null){
			$('#myModal').modal('show');
		}
	})
</script>
	</body>
</html>